require.config({baseUrl:"assets/js",paths:{jquery:"jquery.min","jquery-weui":"jquery-weui","jquery.fullPage":"jquery.fullPage.min"},shim:{"jquery.fullPage":{deps:["jquery"]},"jquery-weui":{deps:["jquery"]}}});var exam={total:0,error:[],answerList:[],isAnswered:[],timeReleased:!1,isStarted:!1,timeLength:3e5,sourceList:[],eachScore:0,isSubmit:!1},lastPage;require(["jquery","jquery.fullPage","jquery-weui"],function(e){function a(e,a){var t=[],n=[];n=s(e.question.length);var i=[];n.map(function(e,a){i[e]=a});var r='<div class="section">';r+='<h1 class="title">第<span>'+a+"</span>题</h1>",r+='<div class="weui_cells_title">'+e.title+"</div>",r+='<div class="weui_cells '+(a%2?"":"weui_cells_dark")+' weui_cells_checkbox" data-id='+(a-1)+" data-answer="+(i[e.answer-1]+1)+">",e.question.map(function(e,s){t[s]="",t[s]+='    <label class="weui_cell weui_check_label">',t[s]+='<div class="weui_cell_hd">',t[s]+='    <input type="radio" class="weui_check" name="radio'+(a-1)+'">',t[s]+='    <i class="weui_icon_checked"></i>',t[s]+="</div>",t[s]+='<div class="weui_cell_bd weui_cell_primary" data-value='+i[s]+">",t[s]+="    <p>"+e+"</p>",t[s]+="</div></label>"});for(var u="",l=0;l<e.question.length;l++)u+=t[n[l]];return r+=u+"</div>\n</div>"}function t(e,a){return Math.random()>.5?-1:1}function s(e){for(var a=[],s=0;e>s;s++)a.push(s);return a.sort(t)}function n(e,a){return e.substring(e.length-a,e.length)}function i(e){var a,t=new Date,s=t.getFullYear(),i=n("0"+(t.getMonth()+1),2),r=n("0"+t.getDate(),2),u=t.getHours(),l=t.getMinutes(),o=t.getSeconds();switch(e){case 0:a=s+"年"+i+"月"+r+"日";break;case 1:a=s+"-"+i+"-"+r+" "+u+":"+l+":"+o;break;case 2:a=s+"年"+i+"月"+r+"日"+u+"时"+l+"分"+o+"秒";break;case 3:a=s+"-"+i+"-"+r+" "+u+":"+l;break;case 4:a=s+"年"+i+"月"+r+"日  "+u+"时"+l+"分";break;case 5:a=i+"/"+r+"/"+s;break;case 6:a=s+"-"+i+"-"+r}return a}var r=[];e('[name="sucessInfo"] .weui_msg_title').hide(),e.getJSON("./assets/data/test.min.json",function(t){var n=t.length;e('[name="nums"]').text(n),exam.eachScore=100/n,e('[name="scores"]').text(exam.eachScore.toFixed(0)),exam.sourceList=s(n);for(var i=0;n>i;i++)e('[name="form"]').before(a(t[exam.sourceList[i]],i+1)),exam.isAnswered[i]=0;for(lastPage=t.length+2,i=0;lastPage>i;i++)r[i]=i%2?"#fff":"#f3f3ff"}).done(function(){document.getElementById("autoplay").play(),u()});var u=function(){function a(){e.alert("答题时间到，系统将不再记录此后的得分，请提交当前成绩！","时间到！",function(){e.fn.fullpage.moveTo(lastPage)})}function t(a,t,s){var n=a-1;"down"==s&&!exam.timeReleased&&n>0&&lastPage-1>n&&!exam.isAnswered[n-1]&&e.alert("第"+n+"题您还没有作答！","警告！",function(){e.fn.fullpage.moveTo(n+1)}),1==a&&"down"==s?e(".iSlider-arrow").removeClass("iSlider-white"):1==t&&"up"==s&&e(".iSlider-arrow").addClass("iSlider-white"),a>=lastPage-1&&"down"==s&&e(".iSlider-arrow").hide()}function s(a){var t=!0;return""==a.user_name?(e('[name="userName"]').parents(".weui_cell").find("label").css("color","#e64340"),t=!1):e('[name="userName"]').parents(".weui_cell").find("label").attr("style",""),""==a.user_id?(e('[name="userCard"]').parents(".weui_cell").find("label").css("color","#e64340"),t=!1):e('[name="userCard"]').parents(".weui_cell").find("label").attr("style",""),t}e(".weui_check_label").on("click",function(){if(exam.timeReleased)a();else{var t=e(this).parents(".weui_cells"),s=e(this).find(".weui_cell_primary"),n=s.data("value")+1==t.data("answer")?1:0;exam.answerList[t.data("id")]=n,exam.isAnswered[t.data("id")]=1}}),e("#fullpage").fullpage({sectionsColor:r,easingcss3:"cubic-bezier(0.25, 0.5, 0.35, 1.15)",onLeave:function(s,n,i){1!=s||exam.timeReleased||(exam.isStarted=!0,setTimeout(function(){exam.timeReleased=!0,a()},exam.timeLength),setTimeout(function(){e.toast("考试时间已过去三分之一")},.33*exam.timeLength),setTimeout(function(){e.toast("考试时间仅剩三分之一")},.67*exam.timeLength)),t(s,n,i)},afterLoad:function(a,t){t==lastPage?e(".iSlider-arrow").hide():t>lastPage?(e(".iSlider-arrow").hide(),exam.isSubmit||setTimeout(function(){e.fn.fullpage.moveSectionUp()},500)):e(".iSlider-arrow").show()}}),e('[name="form"] input').on("focus",function(){e(this).parents(".weui_cell").find("label").attr("style","")}),e('[name="form"] .weui_btn').on("click",function(a){exam.error=[],exam.total=0,exam.answerList.map(function(e,a){exam.total+=e,e||exam.error.push(exam.sourceList[a])});var t="";exam.error.map(function(e){t+=e+","}),t=t.length?t.substring(0,t.length-1):" ";var n={user_name:e('[name="userName"]').val(),user_id:e('[name="userCard"]').val(),score:(exam.total*exam.eachScore).toFixed(0),errors:t,rec_time:i(1)};s(n)?(e('[name="totalScore"]').text(n.score),e('[name="sucessInfo"] .weui_msg_title').show(),e.ajax({url:"http://cbpc540.applinzi.com/index.php?s=/addon/GoodVoice/GoodVoice/setJZExamData",data:n,success:function(a){0==a.status?e('[name="sucessInfo"] h1').text("提交失败，请稍后重试或截屏保存分数"):-1==a.status?e('[name="sucessInfo"] h1').text("该用户已提交数据"):(e('[name="sucessInfo"] h1').text("提交成功"),e(".weui_icon_msg").last().addClass("weui_icon_success"))},error:function(a){0==a.status?e('[name="sucessInfo"] h1').text("提交失败，请稍后重试或截屏保存分数"):-1==a.status?e('[name="sucessInfo"] h1').text("该用户已提交数据"):(e('[name="sucessInfo"] h1').text("提交成功"),e(".weui_icon_msg").last().addClass("weui_icon_success"))}}).always(function(){exam.isSubmit=!0,e.fn.fullpage.moveSectionDown()})):e.toast("请输入个人用户信息","cancel")})};(function(){var e=document.getElementById("autoplay"),a=document.getElementById("musicBtn"),t=document.getElementById("musicBtnTxt");document.getElementById("musicBtn").addEventListener("touchstart",function(){t.style.display="",e.paused?(e.play(),a.className="music-btn on",t.innerHTML="开始"):(e.pause(),a.className="music-btn",t.innerHTML="关闭"),setTimeout(function(){t.style.display="none"},1e3)},!1)})()});
//# sourceMappingURL=main.min.js.map