function GetJsonUrl(a,e,t){function r(a){var t=!1;return $.each(e,function(e,r){e==a&&(t=!0)}),t}var l=getDateRange(),n=getUrlParam("token");null===n&&(n="79d84495ca776ccb523114a2120e273ca80b315b");for(var i=getRootPath()+"/DataInterface/Api?Token="+n+"&ID="+a+"&M=3&tstart="+l.start+"&tend="+l.end+"&tstart2="+l.start+"&tend2="+l.end+"&t="+Math.random(),o=location.href.split("&"),s=1;s<o.length;s++){var m=o[s].split("=")[0],c=o[s].split("=")[1];r(m)||(i+="-1"==c.indexOf(",")?"&"+o[s]:"&"+m+"="+c.split(",")[t])}return i}$("#HideTips").on("click",function(){$(".mt-element-ribbon").addClass("hide")});var isInited=[],mECharts=function(){function a(){require.config({baseUrl:"assets/global/plugins/",paths:{theme:"echarts/theme",echarts:"echarts/js/echarts.min",chartDataTool:"echarts/js/extension/chartDataTool.min",Clipboard:"clipboard/clipboard.min"}}),require(["echarts","chartDataTool","Clipboard"],function(a,t,l){var n;h=a,p=t,u=l,"undefined"==typeof localStorage.eChartsTheme?(n="ali_G2",localStorage.setItem("eChartsTheme","ali_G2")):n=localStorage.eChartsTheme;(function(){new u("#share button")})();require(["theme/"+n],function(a){g=a,e(),y(),r(g)})})}function e(){var a=$(".page-content");for(i=1;i<f;i++){var e='<div class="portlet light bordered" data-chartid = "'+i+'">  <div class="portlet-title">    <div class="page-bar hidden">      <ul class="page-breadcrumb" name="drillName">        <li><i class="icon-home"></i> <a href="javascript:;" data-level="1"></a><i class="fa fa-circle"></i></li>      </ul>    </div>    <button class="btn blue btn-circle" name="downloadExample" data-clipboard-action="copy" data-clipboard-target="#share textarea" data-chartid="'+i+'"><i class="glyphicon glyphicon-download-alt"></i> 下载图表</button>    <a class="btn red btn-circle" name="shareExample" data-chartid="'+i+'"><i class="fa fa-share-alt"></i> 分享 </a>    <div class="actions">      <a class="btn btn-circle btn-icon-only btn-default fullscreen" href="#"></a>    </div>  </div>  <div class="portlet-body form">    <div id="eChart-main'+i+'" optionkey="Line" class="eCharts-main margin-top-5">    </div>  </div></div>';a.append(e)}t()}function t(){var a=getDateRange(),e=getRootPath(0)+"/QualityTable?tid="+getUrlParam("tid")+"&tstart="+a.start+"&tend="+a.end;$('[name="showTable"]').attr({href:e})}function r(a,e){if(f&&h){var t,r={},l={id:getUrlParam("tid").split(","),type:null===getUrlParam("type")?["line"]:getUrlParam("type").split(","),smooth:null===getUrlParam("smooth")?["1"]:getUrlParam("smooth").split(","),blind:null===getUrlParam("blind")?["0"]:getUrlParam("blind").split(","),markLine:null===getUrlParam("markline")?["0"]:getUrlParam("markline").split(","),markLineValue:null===getUrlParam("marklinevalue")?["0"]:getUrlParam("marklinevalue").split(","),markArea:null===getUrlParam("markarea")?["0"]:getUrlParam("markarea").split(","),markAreaValue:null===getUrlParam("markareavalue")?["0"]:getUrlParam("markareavalue").split(","),markPoint:null===getUrlParam("markpoint")?["0"]:getUrlParam("markpoint").split(","),barMaxWidth:null===getUrlParam("barwidth")?["100"]:getUrlParam("barwidth").split(","),splitArea:null===getUrlParam("splitarea")?["0"]:getUrlParam("splitarea").split(","),dataZoom:null===getUrlParam("zoom")?["0"]:getUrlParam("zoom").split(","),minMax:null===getUrlParam("minmax")?["0"]:getUrlParam("minmax").split(","),lineAreaStyle:null===getUrlParam("linearea")?["0"]:getUrlParam("linearea").split(","),lineShadow:null===getUrlParam("lineshadow")?["0"]:getUrlParam("lineshadow").split(","),reverse:null===getUrlParam("reverse")?["0"]:getUrlParam("reverse").split(","),circle:null===getUrlParam("circle")?["0"]:getUrlParam("circle").split(","),roseType:null===getUrlParam("rose")?["0"]:getUrlParam("rose").split(","),dimension:null===getUrlParam("dimension")?["0"]:getUrlParam("dimension").split(","),squareRatio:null===getUrlParam("squareratio")?["1.618"]:getUrlParam("squareratio").split(","),shape:null===getUrlParam("shape")?["polygon"]:getUrlParam("shape").split(","),scatterSize:null===getUrlParam("scattersize")?["20"]:getUrlParam("scattersize").split(","),force:null===getUrlParam("force")?["1"]:getUrlParam("force").split(","),banknoteColor:null===getUrlParam("banknoteColor")?["1"]:getUrlParam("banknoteColor").split(","),stack:null===getUrlParam("stack")?["0"]:getUrlParam("stack").split(","),max:null===getUrlParam("max")?["undefined"]:getUrlParam("max").split(","),min:null===getUrlParam("min")?["undefined"]:getUrlParam("min").split(","),symbolSize:null===getUrlParam("symbolsize")?["12"]:getUrlParam("symbolsize").split(","),opacity:null===getUrlParam("opacity")?["0"]:getUrlParam("opacity").split(","),leafDepth:null===getUrlParam("leafdepth")?["0"]:getUrlParam("leafdepth").split(","),step:null===getUrlParam("step")?["0"]:getUrlParam("step").split(","),singleAxis:null===getUrlParam("singleaxis")?["time"]:getUrlParam("singleaxis").split(","),background:null===getUrlParam("background")?["default"]:getUrlParam("background").split(","),drillID:null===getUrlParam("drill")?["none"]:getUrlParam("drill").split(","),drillType:null===getUrlParam("drilltype")?["none"]:getUrlParam("drilltype").split(","),drillChart:null===getUrlParam("drillchart")?["none"]:getUrlParam("drillchart").split(",")};for(t=0;f>t;t++)r={type:handleParam(l.type,t,"line"),smooth:"1"===handleParam(l.smooth,t,"1"),blind:"0"!==getUrlParam("blind")&&null!==getUrlParam("blind"),toolbox:!0,markLine:handleParam(l.markLine,t,"average"),markLineValue:handleParam(l.markLineValue,t,"0"),markArea:handleParam(l.markArea,t,""),markAreaValue:handleParam(l.markAreaValue,t,"0"),markPoint:"1"===handleParam(l.markPoint,t,"0"),barMaxWidth:handleParam(l.barMaxWidth,t,100),splitArea:"1"===handleParam(l.splitArea,t,"0"),dataZoom:handleParam(l.dataZoom,t,"0"),minMax:"1"===handleParam(l.minMax,t,"0"),lineAreaStyle:"1"===handleParam(l.lineAreaStyle,t,"0"),lineShadow:"1"===handleParam(l.lineShadow,t,"1"),reverse:"1"===handleParam(l.reverse,t,"0"),circle:"1"===handleParam(l.circle,t,"1"),roseType:handleParam(l.roseType,t,"0"),dimension:Number.parseInt(handleParam(l.dimension,t,"1"),10)-1,squareRatio:Number.parseFloat(handleParam(l.squareRatio,t,"1.618")),shape:handleParam(l.shape,t,"polygon"),scatterSize:Number.parseFloat(handleParam(l.scatterSize,t,"20")),force:handleParam(l.force,t,"1"),banknoteColor:handleParam(l.banknoteColor,t,"1"),stack:"1"===handleParam(l.stack,t,"0"),max:handleParam(l.max,t,"1"),min:handleParam(l.min,t,"1"),symbolSize:handleParam(l.symbolSize,t,"12"),opacity:handleParam(l.opacity,t,.4),leafDepth:handleParam(l.leafDepth,t,0),step:handleParam(l.step,t,0),singleAxis:handleParam(l.singleAxis,t,"time"),background:handleParam(l.background,t,"default"),drillID:handleParam(l.drillID,t,"none"),drillType:handleParam(l.drillType,t,"none"),drillChart:handleParam(l.drillChart,t,"none")},r.url=GetJsonUrl(l.id[t],r,t),"undefined"!=typeof a.valueAxis?a.valueAxis.splitArea.show=!!r.splitArea[t]:a.color=["#c23531","#2f4554","#61a0a8","#d48265","#91c7ae","#749f83","#ca8622","#bda29a","#6e7074","#546570","#c4ccd3"],r.color=a.color,b[t]=[],b[t][0]=p.getOption(r,h),b[t][0]!==!1?(P[t]=h.init(document.getElementById("eChart-main"+t),a),P[t].setOption(b[t][0]),"none"!=r.drillID&&($(".eCharts-main").parents(".portlet").find(".page-bar").removeClass("hidden"),v.id[t]=r.drillID.split(";"),v.maxDrillLevel[t]=v.id[t].length,v.obj[t]=$('[name="drillName"]:nth('+t+")"),isInited[t]?v.obj[t].html("<li>"+v.obj[t].find("li").html()+"</li>"):isInited[t]=!0,v.curLevel[t]=1,v.nameLength[t]=0,P[t].chartID=t,P[t].on("click",function(a){var e=$(this)[0].chartID;if(v.curLevel[e]>v.maxDrillLevel[e])switch(r.drillType){case"cart":infoTips("查询车号:"+a.name);break;case"paper":infoTips("查询轴号:"+a.name)}else{P[e].clear();var t={legend:a.seriesName,axis:a.name};r.url=GetJsonUrl(v.id[e][v.curLevel[e]-1],r,e),r.url+="&axis="+t.axis+"&legend="+t.legend,"none"!=r.drillChart&&(v.chartType[e]=r.drillChart.split(";"),v.chartType[e].length<v.curLevel[e]?r.type=v.chartType[e][0]:r.type=v.chartType[e][v.curLevel[e]-1]),b[e][v.curLevel[e]]=p.getOption(r,h),P[e].setOption(b[e][v.curLevel[e]]),v.nameLength[e]<v.curLevel[e]?(v.nameLength[e]++,v.obj[e].append('<li><a href="javascript:;" data-level="'+(v.curLevel[e]+1)+'">'+a.name+'</a><i class="fa fa-circle"></i></li>')):v.obj[e].find("a:nth("+v.curLevel[e]+")").text(a.name),v.curLevel[e]++}}),$('[name="drillName"]').on("click","a",function(){var a=$(this).data("level"),e=$(this).parents(".portlet").data("chartid");P[e].clear(),v.curLevel[e]=a,P[e].setOption(b[e][a-1])})),v.obj[t].find("a").first().text(b[t][0].title[0].text)):bsTips("第"+(t+1)+"张图表无数据，请重新选择查询时间",2);r.blind&&o()}}function l(){if($(".actions select opotion").length)return!1;var a,e=$(".actions select"),t="",r=["default","ali_G2","ali_G2_2","real","real2","real3","powerBI","darkColor","whiteDark","magzin","magzin2","colorful","helianthus","blue","green","red","gray"];r.map(function(a,e){t+='<option value="'+a+'">'+a+"</option>"}),e.html(t),"undefined"==typeof localStorage.eChartsTheme?(a="real2",localStorage.setItem("eChartsTheme","real2")):a=localStorage.eChartsTheme,$('.bs-select[name="ratio"]').find("option").data("icon","fa fa-desktop"),$(".bs-select").selectpicker({iconBase:"fa",tickIcon:"fa-check"}),e.selectpicker("val",a)}function n(a){"undefined"==typeof a&&(a=$('.bs-select[name="ratio"]').val()),localStorage.setItem("chartRatio",a);var e=$(".portlet-body.form"),t=$(".eCharts-main"),r=e.width(),l=r/a;t.css("height",l.toFixed(0))}function o(){for(var a=[],e=0;f>e;e++)a.push(P[e]);h.connect(a)}function s(a){localStorage.setItem("eChartsTheme",a),require(["theme/"+a],function(a){g=a,r(g)}),P[0].showLoading()}function m(){var a=$(".actions select");a&&$(a).change(function(){s($(this).val())})}function c(a){var e=0===v.id.length?0:v.curLevel[a]-1,t='<!DOCTYPE html>\n<html style="height: 100%">\n   <head>\n       <meta charset="utf-8">\n   </head>\n   <body style="height: 100%; margin: 0">\n       <div id="container" style="height: 100%"></div>\n       <script type="text/javascript" src="'+getRootPath(1)+'/assets/global/plugins/echarts/js/echarts.min.js"></script>\n       <script type="text/javascript">\nvar dom = document.getElementById("container");\nvar theme = '+JSON.stringify(g)+";\nvar myChart = echarts.init(dom,theme);\nvar app = {};\noption = null;\noption = "+JSON.stringify(b[a][e]).replace(/null/g,NaN)+'\nif (option && typeof option === "object") {\n    var startTime = +new Date();\n    myChart.setOption(option,true);\n    var endTime = +new Date();\n    var updateTime = endTime - startTime;\n    console.log("Time used:", updateTime);\n}\nwindow.onresize = function(){myChart.resize();};       </script>\n   </body>\n</html>',r=new Blob([t],{type:"text/html;charset=UTF-8",encoding:"UTF-8"}),l=document.createElement("a");l.href=URL.createObjectURL(r),l.download=b[a][e].title[0].text+".html",l.click()}function d(a){var e=0===v.id.length?0:v.curLevel[a]-1;console.log(b[a][e]);var t='<!DOCTYPE html>\n<html style="height: 100%">\n   <head>\n       <meta charset="utf-8">\n   </head>\n   <body style="height: 100%; margin: 0">\n       <div id="container" style="height: 100%"></div>\n       <script type="text/javascript" src="'+getRootPath(1)+'/assets/global/plugins/echarts/js/echarts.min.js"></script>\n       <script type="text/javascript">\nvar dom = document.getElementById("container");\nvar theme = '+JSON.stringify(g)+";\nvar myChart = echarts.init(dom,theme);\nvar app = {};\noption = null;\noption = "+JSON.stringify(b[a][e]).replace(/null/g,NaN)+'\nif (option && typeof option === "object") {\n    var startTime = +new Date();\n    myChart.setOption(option,true);\n    var endTime = +new Date();\n    var updateTime = endTime - startTime;\n    console.log("Time used:", updateTime);\n}\nwindow.onresize = function(){myChart.resize();};       </script>\n   </body>\n</html>',r=$.base64.encode((new Date).getTime());$("#share textarea").text(" "),$.ajax({url:getRootPath(0)+"/demo/chartShare.php",type:"POST",async:!1,data:{filename:r+".html",contents:t},success:function(a){try{var e=$.parseJSON(a),t=getRootPath(0)+e.url;$("#share textarea").text(t),$("#successShare").click()}catch(r){console.log(r),infoTips(a),bsTips("图表分享失败，请稍后重试",0)}},error:function(a){console.log(a),bsTips("图表分享失败，请稍后重试",0)}})}var h,p,u,g,P=[],f=null===getUrlParam("tid")?0:getUrlParam("tid").split(",").length,v={obj:[],curLevel:[],nameLength:[],id:[],maxDrillLevel:[],chartType:[]},b=[],y=function(){var a=$('.bs-select[name="ratio"]');a.find("option").data("icon","fa fa-down"),"undefined"==typeof localStorage.chartRatio?(chartRatio=1.5,localStorage.setItem("chartRatio",chartRatio)):(chartRatio=localStorage.chartRatio,a.selectpicker("val",chartRatio),n(chartRatio)),a&&$(a).change(function(){for(n($(this).val()),i=0;i<f;i++)P[i].resize()})};return $(document).on("click",".ranges li:not(:last),button.applyBtn",function(){var a;a=$(".actions select"),require(["theme/"+a.val()],function(a){g=a,setTimeout(r(g),500)}),t()}),$("#Preview a").on("click",function(){var a=$("#Preview input").val(),e=$(".actions select");require(["theme/"+e.val()],function(e){g=e,setTimeout(r(g,a+"&chartType=line"),500)})}),$(".page-content").on("click",'[name="shareExample"]',function(){d($(this).data("chartid"))}),$(".page-content").on("click",'[name="downloadExample"]',function(){c($(this).data("chartid"))}),{init:function(){l(),a(),m()},resize:function(){for(n(),i=0;i<f;i++)P[i].resize()}}}();jQuery(document).ready(function(){initDashboardDaterange("YYYYMMDD"),initDom(),mECharts.init(),1==App.getURLParameter("debug")||null===App.getURLParameter("tid")?$("#Preview").show():$("#Preview").hide(),hideSidebarTool()}),jQuery(window).resize(function(){HeadFix(),mECharts.resize()});
//# sourceMappingURL=QualityChart.min.js.map