var PaperParam=function(){function t(){var t=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=23&M=3&t=1",e=ReadData(t);InitSelect("machine_ID",e),t=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=25&M=3&t=3",e=ReadData(t),InitSelect("oper_ID",e),$("input[name='rec_date']").val(today(6)),$("input[name='remark']").val("无");var a=ReadData(getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=30&M=3");$('input[name="pulp_code"]').val(a.data[0]),initSelect2(),$(".page-header .dropdown-quick-sidebar-toggler").hide()}function e(){var t=(new Date).getHours();t>=0&&8>t?SetiCheckChecked("class_id",2):t>=8&&16>t?SetiCheckChecked("class_id",0):SetiCheckChecked("class_id",1)}function a(){return""===$('select[name="oper_ID"]').val()||""===$('select[name="machine_ID"]').val()?($(".portlet.light").hide(),1):($(".portlet.light").show(),0)}function o(){var t=$("input[name='rec_date']").val();t=t.replace(/-/g,"");var e=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=26&M=3&tstart="+t+"&tend="+t,a=ReadData(e);$(".page-toolbar button").html("当天已录入数据："+a.rows+"条"),$(".page-toolbar ul").html("");for(var o=0;o<a.rows;o++)$(".page-toolbar ul").append('<li><a href="'+getRootPath(1)+"/PaperPara/chemy#p="+a.data[o][1]+'">'+a.data[o][1]+"</a></li>"),o&&o%3===0&&$(".page-toolbar ul").append('<li class="divider"></li>')}function n(t){if("undefined"==typeof t){var e=window.location.hash.substr(1).match(RegExp("(^|&)p=([^&]*)(&|$)"));if(null===e)return;t=unescape(e[2])}$('input[name="pulp_code"]').val(t);var a=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=32&M=0&p="+t,o=ReadData(a);o.header.map(function(t){var e=t.title;$('form .form-control[name="'+e+'"]').val(o.data[0][e])}),SetSelect2Val("oper_ID",o.data[0].oper_ID),SetSelect2Val("machine_ID",o.data[0].machine_ID),SetiCheckChecked("class_id",o.data[0].class_id),$('.portlet button[type="submit"]').data("sn",o.data[0].ID),$('.portlet button[type="submit"]').html($('.portlet button[type="submit"]').html().replace("提交","更新")),$(".portlet.light").show()}var i=function(){jQuery().datepicker&&$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"yyyy-mm-dd"})};return $('select[name="oper_ID"]').change(function(){a()}),$('select[name="machine_ID"]').change(function(){a()}),{init:function(){$(".portlet.light").hide(),i(),t(),iCheckBoxInit(),e(),o(),$('button[type="reset"]').on("click",function(){SetSelect2Val("oper_ID",-1),SetSelect2Val("machine_ID",-1),$(".portlet.light").hide(),e(),$(".amounts h4").html("<strong>评价总分:</strong> 100"),$('.portlet button[type="submit"]').html($('.portlet button[type="submit"]').html().replace("更新","提交"))}),$("form[name=theForm]").submit(function(){var t,e;return"提交"!==$('.portlet button[type="submit"]').text().trim()?(t=getRootPath()+"/DataInterface/update",e={url:t,type:"post",resetForm:!0,data:{tbl:TBL.CHEM,class_id:GetiCheckChecked("class_id"),utf2gbk:["remark"],id:$('.portlet button[type="submit"]').data("sn"),record_Time:today(1)},success:function(t){var e=$.parseJSON(t);infoTips(e.message,e.type),$('button[type="reset"]').click(),$(".portlet.light").hide();var a=ReadData(getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=30&M=3");$('input[name="pulp_code"]').val(a.data[0]),$('.portlet button[type="submit"]').html($('.portlet button[type="submit"]').html().replace("更新","提交"))},error:function(t){infoTips(JSON.stringify(t))}}):(t=getRootPath()+"/DataInterface/insert",e={url:t,type:"post",resetForm:!0,data:{tbl:TBL.CHEM,class_id:GetiCheckChecked("class_id"),utf2gbk:["remark"],record_Time:today(1),pulp_code:$('input[name="pulp_code"]').val()},success:function(t){var e=$.parseJSON(t);infoTips(e.message,e.type),$('button[type="reset"]').click(),$(".portlet.light").hide(),$(".page-toolbar button").text("当天已录入数据："+(parseInt($(".page-toolbar button").text().replace("当天已录入数据：","").replace("条",""),10)+1)+"条");var a=ReadData(getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=30&M=3");$('input[name="pulp_code"]').val(a.data[0]),$("input[name='rec_date']").val(today(6)),o();var a=ReadData(getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=30&M=3");$('input[name="pulp_code"]').val(a.data[0])},error:function(t){infoTips(JSON.stringify(t))}}),$(this).ajaxSubmit(e),!1}),$(document).on("click",".page-toolbar a",function(){var t=$(this).attr("href").split("#p=")[1];n(t)}),n()}}}();jQuery(document).ready(function(){initDom(),PaperParam.init()}),jQuery(window).resize(function(){HeadFix()});
//# sourceMappingURL=PaperPara_chemy.min.js.map