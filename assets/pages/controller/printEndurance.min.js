var store,printEndurance=function(){function t(){var t=store.state.basic.rec_date.replace(/-/g,"");t=t.replace(/-/g,"");var e=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=328&M=3&tstart="+t+"&tend="+t;$.ajax({url:e}).done(function(t){var e=handleAjaxData(t);store.state.tbl=e})}function e(){var t=getRootPath(1)+"/DataInterface/Api?Token="+config.TOKEN+"&ID=35&M=3&t=1&cache=14400";$.ajax({url:t}).done(function(t){handleAjaxData(t).data.forEach(function(t){store.state.prodList.push({value:t[0],name:t[1]})}),initSelect2(),$(".select2").on("select2:select",function(){a($(this).val())})})}function a(t){switch(store.state.basic.prod_id=t,store.state.params.forEach(function(t,e){store.state.params[e].data="0"}),t){case"2":store.state.params[1].show=!1,store.state.params[2].show=!1,store.state.params[4].show=!1,store.state.params[5].show=!1;break;case"3":case"4":case"6":case"7":store.state.params[1].show=!0,store.state.params[2].show=!1,store.state.params[4].show=!0,store.state.params[5].show=!1;break;case"8":store.state.params[1].show=!0,store.state.params[2].show=!0,store.state.params[4].show=!0,store.state.params[5].show=!0}}function r(){store=new Vuex.Store({state:{params:[{name:"耐干皱折(正面)",data:"0",key:"anti_CreaseF",show:!0},{name:"耐干皱折(反面)",data:"0",key:"anti_CreaseB",show:!0},{name:"耐干皱折(OVMI)",data:"0",key:"anti_CreaseOVMI",show:!0},{name:"机洗(正)",data:"0",key:"washF",show:!0},{name:"机洗(背)",data:"0",key:"washB",show:!0},{name:"抗剥离",data:"0",key:"anti_scrab",show:!1}],basic:{remark:"无",prod_id:"0",rec_date:today(6),gznumber:""},prodList:[{value:0,name:""}],tbl:{rows:0}},mutations:{submit:function(){var t=store.state,e={};for(var a in t.basic)e[a]=t.basic[a];t.params.forEach(function(t){e[t.key]=t.data}),e.gznumber=e.gznumber.toUpperCase(),s(e)},reset:function(){var t=store.state.params;t.forEach(function(e,a){t[a].data="0"})},loadHisData:function(){t()}}});new Vue({el:"#basic",store:!0,computed:{basic:function(){return store.state.basic},prodList:function(){return store.state.prodList}},mounted:function(){e()}}),new Vue({el:"#report",store:!0,data:{portletName:"耐性检测结果"},components:{"my-input":{template:"#my-input-template",props:["param"]}},computed:{params:function(){return store.state.params}},methods:{submit:function(){store.commit("submit")},reset:function(){store.commit("reset")},loadHisData:function(){store.commit("loadHisData")}},mounted:function(){n()}}),new Vue({el:"#sheet",store:!0,components:{"my-table":{template:"#my-table-template",props:["tbl"]}},computed:{tbl:function(){return store.state.tbl}}})}function s(e){var a=getRootPath()+"/DataInterface/insert";e.tbl=TBL.PRINT_ENDURANCE,e.utf2gbk=["remark"],e.rec_time=today(1);var r={url:a,type:"post",resetForm:!0,data:e,success:function(e){var a=$.parseJSON(e);bsTips(a.message,a.type),store.commit("reset"),t()},error:function(t){infoTips(JSON.stringify(t))}};return $.ajax(r),!1}var o=function(){$.fn.datepicker.dates["zh-CN"]={days:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],daysShort:["周日","周一","周二","周三","周四","周五","周六"],daysMin:["日","一","二","三","四","五","六"],months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthsShort:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],today:"今日",clear:"清除",format:"yyyy年mm月dd日",titleFormat:"yyyy年mm月",weekStart:1},jQuery().datepicker&&$(".date-picker").datepicker({rtl:App.isRTL(),orientation:"left",autoclose:!0,format:"yyyy-mm-dd",language:"zh-CN"}).on("changeDate",function(t){store.state.basic.rec_date=t.date.toLocaleString().replace(/\/|年|月/g,"-").replace(/日/g,"").split(" ")[0]})},n=function(){jQuery.validator.addMethod("gznumber",function(t,e){return this.optional(e)||/^[A-Za-z]{2}$|^[A-Za-z]\*[A-Za-z]$|^[A-Za-z]\*\*[A-Za-z]$|^[A-Za-z]\*\*\*[A-Za-z]$|^[A-Za-z]\*\*\*[A-Za-z]$/.test(t)},"请检查冠字信息是否正确"),$("#gznumber").maxlength({limitReachedClass:"label label-danger",threshold:4});$("form[name=theForm]").validate({errorElement:"span",errorClass:"help-block",focusInvalid:!0,rules:{gznumber:{gznumber:!0,required:!0},anti_CreaseF:{number:!0,required:!0},anti_CreaseB:{number:!0},anti_scrab:{number:!0},anti_CreaseOVMI:{number:!0},washF:{number:!0,required:!0},washB:{number:!0}},messages:{gznumber:{required:"冠字信息不能为空."}},highlight:function(t){$(t).closest(".form-group").addClass("has-error")},success:function(t){t.closest(".form-group").removeClass("has-error"),t.remove()},submitHandler:function(){store.commit("submit")}})};return{init:function(){$(".page-header .dropdown-quick-sidebar-toggler").hide(),r(),o()}}}();jQuery(document).ready(function(){printEndurance.init(),initDom()}),jQuery(window).resize(function(){HeadFix()});