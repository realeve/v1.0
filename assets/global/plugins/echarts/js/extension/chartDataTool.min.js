define(["../plugins/echarts/js/extension/dataTool.min","../plugins/echarts/js/extension/statisticsTool.min"],function(e,t){function a(e,t){var a={};return t=t?"GET":"POST",$.ajax({type:t,async:!1,url:e,success:function(e,t){var r=jQuery.parseJSON(e);a=r},error:function(e){console.log("read data error:<br>"),console.log(e.responseText)}}),a}function r(e,t){var a=[];return e.map(function(e){"undefined"!=typeof l[e]&&a.push(l[e])}),a.concat(t)}var o,s,l={"9602A":"#7ECF51","103-G-2A":"#7ECF51","9603A":"rgb(189,66,175)","103-G-3A":"rgb(189,66,175)","9604A":"#61A5E8","103-G-4A":"#61A5E8","9605A":"rgb(200,200,30)","103-G-5A":"rgb(200,200,30)","9606A":"#3D7F18","103-G-6A":"#3D7F18","9607T":"rgb(255,127,104)","103-G-7T":"rgb(255,127,104)"},n=function(r){function o(e,t){return e-t}function s(e){isNaN(e[0])?e.sort():e.sort(o);var t=[],a=[];return e.map(function(e){1!=a[e]&&(t.push(e),a[e]=1)}),t}function l(e){return["序列 "+e.seriesName+": ","分组 "+e.name+": ","上须: "+e.data[4].toFixed(3),"较高四分位点(Q1): "+e.data[3].toFixed(3),"中位数: "+e.data[2].toFixed(3),"较低四分位点(Q3): "+e.data[1].toFixed(3),"下须: "+e.data[0].toFixed(3)].join("<br/>")}function n(e){return["序列 "+e.seriesName+": ","分组 "+e.name+": ","最大值: "+e.data[4].toFixed(3),"较高四分位点(Q1): "+e.data[3].toFixed(3),"中位数: "+e.data[2].toFixed(3),"较低四分位点(Q3): "+e.data[1].toFixed(3),"最小值: "+e.data[0].toFixed(3)].join("<br/>")}function d(e,t,a,r){var i=[];return"undefined"==typeof a?e.map(function(e,a){i[a]=e[t]}):e.map(function(e,o){e[r]==a&&(i[o]=e[t])}),s(i)}function x(e,t){var a=[];return e.map(function(e,r){a[r]=e[t]}),a}function m(e,t){var a,r=e[0][t],i=e[0][t];return e.map(function(e,o){a=Number.parseFloat(e[t]),r>a?r=a:a>i&&(i=a)}),{min:Math.floor(r).toFixed(0),max:Math.ceil(i).toFixed(0)}}function h(e){var t=[];return e.map(function(e,a){isNaN(e)&&t.push(a)}),t}function p(e){var t,r,i,o,s=[];t=a(e.url),s.title=t.title,s.subTitle=t.source,s.rows=t.rows;var l={normal:{label:{show:!0,position:e.reverse?"insideRight":"insideTop",formatter:"{c}"},barBorderRadius:e.reverse?[0,2,2,0]:[2,2,0,0]}};if(0===t.rows)return s;var n,m,p,u={average:"平均值",min:"最小值",max:"最大值"};if(t.cols>3){s.xAxisTitle=" ",s.yAxisTitle=" ";var y=h(t.data[0]),c=0;y.length>0&&0==y[0]?(s.legend=d(t.data,0),c=1):(s.legend=[],s.legend[0]=s.yAxisTitle),s.xAxis=[];for(var i=c;i<t.header.length;i++)s.xAxis.push(t.header[i].title);s.yAxis=[],s.series=[],t.data.map(function(t){var a={name:c?t[0]:" ",type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:15,data:c?t.slice(1,t.length):t,itemStyle:l,symbolSize:e.symbolSize};e.lineAreaStyle&&(a.areaStyle={normal:{opacity:"0"!=e.opacity?e.opacity:.4}},a.lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(n=e.markLineValue.split(";"),m=e.markLine.split(";"),p=m.length,"0"!=e.markLine&&(a.markLine={lineStyle:{normal:{type:"dashed"}},symbolSize:0,label:{normal:{position:"end",formatter:"{b}:\n{c}"}},data:[]},"min"!=m[0]&&"max"!=m[0]&&"average"!=m[0]?n.map(function(t,r){a.markLine.data.push({name:decodeURI(1==p?e.markLine:m[r]),yAxis:Number.parseFloat(t)})}):m.map(function(t,r){a.markLine.data.push({type:decodeURI(1==p?e.markLine:m[r]),name:u[1==p?e.markLine:m[r]]})})),e.markPoint&&(a.markPoint=MPtStyleBoth)),"line"==e.type&&(a.label={normal:{show:!1,position:"top"}}),s.series.push(a)})}else if(3==t.cols){for(s.xAxisTitle=t.header[1].title,s.yAxisTitle=t.header[2].title,s.legend=d(t.data,0),s.xAxis=d(t.data,1),s.yAxis=[],i=0;i<s.legend.length;i++)for(s.yAxis[s.legend[i]]=[],o=0;o<s.xAxis.length;o++)s.yAxis[s.legend[i]][o]="-";for(i=0;i<t.rows;i++)for(r=t.data[i][0],o=0;o<s.xAxis.length;o++)if(t.data[i][1]==s.xAxis[o]){s.yAxis[r][o]=Number.parseFloat(t.data[i][2]);break}for(s.series=[],i=0;i<s.legend.length;i++)s.series[i]={name:s.legend[i],type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:15,data:s.yAxis[s.legend[i]],itemStyle:l,symbolSize:e.symbolSize,sampling:"average"},e.lineAreaStyle&&(s.series[i].areaStyle={normal:{opacity:"0"!=e.opacity?e.opacity:.4}},s.series[i].lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(n=e.markLineValue.split(";"),m=e.markLine.split(";"),p=m.length,"0"!=e.markLine&&(s.series[i].markLine={lineStyle:{normal:{type:"dashed"}},symbolSize:0,label:{normal:{position:"end",formatter:"{b}:\n{c}"}},data:[]},"min"!=m[0]&&"max"!=m[0]&&"average"!=m[0]?n.map(function(t,a){s.series[i].markLine.data.push({name:decodeURI(1==p?e.markLine:m[a]),yAxis:Number.parseFloat(t)})}):m.map(function(t,a){s.series[i].markLine.data.push({type:decodeURI(1==p?e.markLine:m[a]),name:u[1==p?e.markLine:m[a]]})})),e.markPoint&&(s.series[i].markPoint=MPtStyleBoth)),"line"==e.type&&(s.series[i].label={normal:{show:!1,position:"top"}})}else if(2==t.cols)s.xAxisTitle=t.header[0].title,s.yAxisTitle=t.header[1].title,s.legend=[],s.legend[0]=s.yAxisTitle,s.xAxis=x(t.data,0),s.yAxis=x(t.data,1),s.series=[],s.series[0]={name:s.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:15,data:s.yAxis,itemStyle:l,symbolSize:e.symbolSize,sampling:"average"},e.lineAreaStyle&&(s.series[0].areaStyle={normal:{opacity:"0"!=e.opacity?e.opacity:.4}},s.series[0].lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(n=e.markLineValue.split(";"),m=e.markLine.split(";"),p=m.length,"0"!=e.markLine&&(s.series[0].markLine={lineStyle:{normal:{type:"dashed"}},symbolSize:0,label:{normal:{position:"end",formatter:"{b}:\n{c}"}},data:[]},"min"!=m[0]&&"max"!=m[0]&&"average"!=m[0]?n.map(function(t,a){s.series[0].markLine.data.push({name:decodeURI(1==p?e.markLine:m[a]),yAxis:Number.parseFloat(t)})}):m.map(function(t,a){s.series[0].markLine.data.push({type:decodeURI(1==p?e.markLine:m[a]),name:u[1==p?e.markLine:m[a]]})})),e.markPoint&&(s.series[0].markPoint=MPtStyleBoth)),"line"==e.type&&(s.series[0].label={normal:{show:!1,position:"top"}});else if(1==t.cols){for(s.xAxisTitle="数据编号",s.yAxisTitle=t.header[0].title,s.legend=[],s.legend[0]=s.yAxisTitle,arrTemp=[],i=0;i<t.rows;i++)arrTemp[i]=i+1;for(s.xAxis=arrTemp,s.yAxis=[],i=0;i<t.rows;i++)s.yAxis[i]=Number.parseFloat(t.data[i][0]);s.series=[],s.series[0]={name:s.yAxisTitle,type:e.type,smooth:e.smooth,barMaxWidth:e.barMaxWidth,barMinHeight:15,data:s.yAxis,itemStyle:l,symbolSize:e.symbolSize,sampling:"average"},e.lineAreaStyle&&(s.series[0].areaStyle={normal:{opacity:"0"!=e.opacity?e.opacity:.4}},s.series[0].lineStyle={normal:{width:0,type:"solid",shadowColor:"rgba(0,0,0,0)",shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0}}),e.reverse||(n=e.markLineValue.split(";"),m=e.markLine.split(";"),p=m.length,"0"!=e.markLine&&(s.series[0].markLine={lineStyle:{normal:{type:"dashed"}},symbolSize:0,label:{normal:{position:"end",formatter:"{b}:\n{c}"}},data:[]},"min"!=m[0]&&"max"!=m[0]&&"average"!=m[0]?n.map(function(t,a){s.series[0].markLine.data.push({name:decodeURI(1==p?e.markLine:m[a]),yAxis:Number.parseFloat(t)})}):m.map(function(t,a){s.series[0].markLine.data.push({type:decodeURI(1==p?e.markLine:m[a]),name:u[1==p?e.markLine:m[a]]})})),e.markPoint&&(s.series[0].markPoint=MPtStyleBoth)),"line"==e.type&&(s.series[0].label={normal:{show:!1,position:"top"}})}if(e.stack)for(i=0;i<s.legend.length;i++){s.series[i].stack="总量",s.series[i].itemStyle.normal.barBorderRadius=0,s.series[i].symbolSize=0;var f=JSON.stringify(s.series[i].data);f=f.replace(/"-"/g,0),s.series[i].data=$.parseJSON(f)}return s}function u(e,t){for(var a=0;a<t.length;a++)t[a].sort(o),e.boxData[a][0]=t[a][0],e.boxData[a][4]=t[a][t[a].length-1];return e}function y(t){var r,o=a(t.url),s=[];if(s.title=o.title,s.subTitle=o.source,s.rows=o.rows,s.series=[],0===o.rows)return s;if(3==o.cols){s.xAxisTitle=o.header[1].title,s.yAxisTitle=o.header[2].title,s.legend=d(o.data,0),s.xAxis=d(o.data,1);var x=[];for(i=0;i<s.legend.length;i++)for(x[s.legend[i]]=[],j=0;j<s.xAxis.length;j++)x[s.legend[i]][j]=[];for(i=0;i<o.rows;i++)for(iTemp=o.data[i][0],j=0;j<s.xAxis.length;j++)if(o.data[i][1]==s.xAxis[j]){x[iTemp][j].push(Number.parseFloat(o.data[i][2]));break}s.legend.map(function(a,i){r=e.prepareBoxplotData(x[a],{layout:t.reverse?"vertical":"horizontal"}),t.minMax&&(r=u(r,x[a])),s.series[i]={name:a,type:t.type,data:r.boxData,tooltip:{backgroundColor:"#fff",textStyle:{color:"#333"},extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",formatter:t.minMax?n:l}},s.series[i+3]={name:a,type:"scatter",data:r.outliers}})}else if(2==o.cols){for(s.xAxisTitle=o.header[0].title,s.yAxisTitle=o.header[1].title,s.xAxis=d(o.data,0),s.yAxis=[],i=0;i<s.xAxis.length;i++)s.yAxis[i]=[];for(i=0;i<o.rows;i++)for(iTemp=o.data[i][0],j=0;j<s.xAxis.length;j++)if(iTemp==s.xAxis[j]){s.yAxis[j].push(Number.parseFloat(o.data[i][1]));break}r=e.prepareBoxplotData(s.yAxis),t.minMax&&(r=u(r,s.yAxis)),s.legend=[],s.legend[0]=s.yAxisTitle,s.series[0]={name:s.yAxisTitle,type:t.type,data:r.boxData,tooltip:{backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"},formatter:t.minMax?n:l}},s.series[1]={name:s.yAxisTitle,type:"scatter",data:r.outliers}}else if(1==o.cols){for(s.xAxisTitle="数据编号",s.yAxisTitle=o.header[0].title,s.legend=[],s.legend[0]=s.yAxisTitle,s.xAxis=["数据1"],s.yAxis=[],s.yAxis[0]=[],i=0;i<o.rows;i++)s.yAxis[0][i]=Number.parseFloat(o.data[i][0]);r=e.prepareBoxplotData(s.yAxis),t.minMax&&(r=u(r,s.yAxis)),s.series[0]={name:s.yAxisTitle,type:t.type,data:r.boxData,tooltip:{backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"},formatter:t.minMax?n:l}},s.series[1]={name:s.yAxisTitle,type:"scatter",data:r.outliers}}return s}function c(e,t,a){var r={},i=[];e.map(function(e){"undefined"==typeof r[e[t]]?r[e[t]]=Number.parseFloat(e[a]):r[e[t]]+=Number.parseFloat(e[a])});for(var o in r)i.push({value:r[o].toFixed(2),name:o});return i}function f(e,t,a,r){var i=[],o=0;return e.map(function(e){0===o?(i.push({value:Number.parseFloat(e[a]).toFixed(2),name:e[t],itemStyle:{normal:{color:r[e[0]]}}}),o++):i[o-1].name==e[t]?(i[o-1].value=Number.parseFloat(i[o-1].value)+Number.parseFloat(e[a]),i[o-1].value=i[o-1].value.toFixed(2)):(i.push({value:Number.parseFloat(e[a]).toFixed(2),name:e[t],itemStyle:{normal:{color:r[e[0]]}}}),o++)}),i}function g(e,t){var a=d(e.data,0),r={},i=t.length;return a.map(function(e,a){r[e]=t[a%i]}),r}function b(e){var t=a(e.url),r=[];if(r.title=t.title,r.subTitle=t.source,r.rows=t.rows,r.series=[],0===t.rows)return r;if(t.cols>2){for(var i=[],o=0;o<t.header.length-1;o++)i.push(t.header[o].title);r.legend={orient:"vertical",x2:"5%",data:i};var s=g(t,e.color),l=t.cols-1,n=80/l;for(o=0;l>o;o++)r.series.push({name:t.header[o].title,type:"pie",selectedMode:"single",radius:[o*n+(o>0?0:5)+"%",(o+1)*n+"%"],data:f(t.data,o,l,s),label:{normal:{show:3>l?!0:!1,position:"inner"}},itemStyle:{normal:{borderColor:"#fbfbfb",borderWidth:1,opacity:1-.2*(o/l)},emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}})}else if(2==t.cols)r.legend={orient:"vertical",x2:"5%",data:d(t.data,0)},r.series=[{name:t.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:c(t.data,0,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"]);else if(1==t.cols){r.legend={show:!1,orient:"vertical",x2:"5%",data:t.header[0].title};var x;t.data.map(function(e,t){x.push({value:Number.parseFloat(e).toFixed(2),name:"数据"+(t+1)})}),r.series=[{name:t.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:x,itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"])}return t.cols<3&&(elem.data.length<=6?(r.series[0].label={normal:{position:"inner"}},r.series[0].labelLine={normal:{show:!1}}):r.series[0].labelLine={normal:{show:!0,length2:10,length:15}}),r}function w(e){var t=a(e.url),r=[];if(r.title=t.title,r.subTitle=t.source,r.rows=t.rows,r.series=[],0===t.rows)return r;if(3==t.cols)r.legend={orient:"vertical",x2:"5%",data:d(t.data,0).concat(d(t.data,1))},r.series=[{name:t.header[0].title,type:e.type,selectedMode:"single",radius:[0,"35%"],data:c(t.data,0,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}},{name:t.header[1].title,type:e.type,radius:["50%","70%"],data:c(t.data,1,2),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"50%"],r.series[1].radius=[0,"50%"],r.series[0].center=["25%","50%"],r.series[1].center=["75%","50%"]),"0"!=e.roseType&&(r.series[0].roseType=e.roseType,r.series[0].radius=["10%","50%"],r.series[0].center=["25%","50%"],r.series[1].roseType=e.roseType,r.series[1].radius=["10%","50%"],r.series[1].center=["75%","50%"]);else if(2==t.cols)r.legend={orient:"vertical",x2:"5%",data:d(t.data,0)},r.series=[{name:t.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:c(t.data,0,1),itemStyle:{emphasis:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"]),"0"!=e.roseType&&(1==r.series.length?r.series[0].roseType=e.roseType:(r.series[0].roseType=e.roseType,r.series[0].radius=["10%","50%"],r.series[0].center=["25%","50%"],r.series[1].roseType=e.roseType,r.series[1].radius=["10%","50%"],r.series[1].center=["75%","50%"]));else if(1==t.cols){r.legend={show:!1,orient:"vertical",x2:"5%",data:t.header[0].title};var i;t.data.map(function(e,t){i.push({value:Number.parseFloat(e).toFixed(2),name:"数据"+(t+1)})}),r.series=[{name:t.header[0].title,type:e.type,selectedMode:"single",radius:[0,"30%"],data:i}],e.circle||(r.series[0].radius=[0,"60%"],r.series[0].center=["50%","50%"]),"0"!=e.roseType&&(r.series[0].roseType=e.roseType)}return r.series.map(function(e,t){e.data.length<=6?(r.series[t].label={normal:{position:"inner"}},r.series[t].labelLine={normal:{show:!1}}):r.series[t].labelLine={normal:{show:!0,length2:10,length:15}}}),r}function S(e,t,a){var r=[],i={normal:{width:1,opacity:.5}},o={};return"undefined"!=typeof t.data?(t.data.map(function(e){o[e]=[]}),e.map(function(e){o[e[0]].push(e.slice(1,e.length))}),t.data.map(function(e,t){r.push({name:e,type:a,lineStyle:i,data:o[e]})})):r.push({name:"平行坐标",type:a,lineStyle:i,data:e}),r}function v(e,t){for(var a=-1,r=e.length-1,i=r;null!=e[i]&&-1==a;i--)if(e[i].name==t)return a=i;return a}function A(e,t,a){if(t.length-1==a.deepLevel)return e;var r=t[a.deepLevel],i=v(e,r);return-1==i?(e.push({name:r,value:a.value}),i=e.length-1,t.length-2>a.deepLevel&&(e[i].children=[])):(e[i].value+=a.value,null==e[i].children&&t.length-2>a.deepLevel&&(e[i].children=[])),a.deepLevel++,t.length-1>a.deepLevel&&(e[i].children=A(e[i].children,t,a)),e}function k(e){var t,a=[],r=e[0].length-1;return e.map(function(e){t={value:Number.parseFloat(e[r]),deepLevel:0},a=A(a,e,t)}),a}function T(e){var t={};return e.map(function(e){isNaN(t[e[0]])&&(t[e[0]]=[]);for(var a=[],r=1;r<e.length;r++)a.push(Number.parseFloat(e[r]).toFixed(2));t[e[0]].push(a)}),t}function L(e,t){var a={radarIndicator:[],series:[],legend:{}},r=0,i=h(e.data[0]);i.length>0&&0===i[0]&&(a.legend={data:d(e.data,0),orient:"vertical",left:"left"},r=1);for(var o=r;o<e.cols;o++){var s=m(e.data,o);s.max=1.1*s.max,a.radarIndicator.push({name:e.header[o].title,max:s.max.toFixed(0)})}if(r){var l=T(e.data);for(var n in l)a.series.push({name:n,type:"radar",symbol:"none",areaStyle:{normal:{opacity:"0"!=t.opacity?t.opacity:.3}},lineStyle:{normal:{width:1,opacity:.5}},data:l[n]})}else a.series.push({name:e.title,type:"radar",symbol:"none",areaStyle:{normal:{opacity:"0"!=t.opacity?t.opacity:.3}},lineStyle:{normal:{width:1,opacity:.5}},data:e.data});return a}function W(e){var t=a(e.url),r=[];if(r.title=t.title,r.subTitle=t.source,r.rows=t.rows,r.series=[],r.legend=[],r.visualMap=[],r.parallelAxis=[],1===t.cols||0===t.rows)return r;var i=h(t.data[0]),o=0;if(i.length>0&&0===i[0]){var s=d(t.data,0);r.legend={top:20,data:s,itemGap:20,x:"10",top:"20",width:"500",textStyle:{color:"#aaa",fontSize:14}},o=1,s.length<2&&(r.legend.show=!1)}0===o&&(r.legend.show=!1);for(var l=o;l<t.cols;l++){var n=m(t.data,l);r.parallelAxis.push({dim:l-o,name:t.header[l].title,max:n.max,min:n.min})}for(l=o;l<i.length;l++)r.parallelAxis[i[l]-o].type="category",r.parallelAxis[i[l]-o].data=d(t.data,i[l]);return n=m(t.data,e.dimension),r.visualMap={show:!1,min:n.min,max:n.max,dimension:e.dimension-o,calculable:!0,inRange:{color:["#e92312","#a2ca36","#50a3ba"].reverse()}},r.series=S(t.data,r.legend,e.type),r}function C(e){function t(){return[{itemStyle:{normal:{borderWidth:0,gapWidth:3,borderColor:"black"}}},{itemStyle:{normal:{gapWidth:2,borderColor:"black"}}},{colorSaturation:[.25,.4],itemStyle:{normal:{gapWidth:1,borderColor:"black"}}}]}var r=a(e.url);if(0===r.rows)return!1;var i={title:r.title,subTitle:r.source,rows:r.rows,series:[{name:r.header[r.cols-1].title,type:e.type,label:{show:!0,formatter:"{b}"},squareRatio:e.squareRatio,width:"100%",height:"90%",top:55,itemStyle:{normal:{borderColor:"black"}},levels:t(),data:k(r.data)}]};return i}function N(e){var t=a(e.url);if(0===t.rows||t.cols<3)return!1;var r=L(t,e),i={title:t.title,subTitle:t.source,rows:t.rows,radarIndicator:r.radarIndicator,series:r.series,legend:r.legend};return i}function z(e,t){var a={};e.data.map(function(e){"undefined"==typeof a[e[0]]&&(a[e[0]]={name:e[0],type:"scatter",symbolSize:function(e){var a=t*e[1];return a.toFixed(0)},data:[]});for(var r=[],i=1;i<e.length;i++)r.push(Number.parseFloat(e[i]).toFixed(2));a[e[0]].data.push(r)});var r=[];for(var i in a)r.push(a[i]);return r}function F(e){var t=a(e.url);if(0===t.rows||1===t.cols||t.cols<=2&&isNaN(t.data[0][0]))return!1;var r=isNaN(t.data[0][0]),i={title:t.title,subTitle:t.source,rows:t.rows,xAxisName:r?t.header[1].title:t.header[0].title,yAxisName:r?t.header[2].title:t.header[1].title};if(r){i.legend={data:d(t.data,0),left:"left"};var o=m(t.data,2),s=e.scatterSize/o.max;i.series=z(t,s)}else{var o=m(t.data,1),s=e.scatterSize/o.max;i.series={type:"scatter",symbolSize:function(e){var t=s*e[1];return t.toFixed(0)},data:t.data}}return i}function M(e){for(var t={nodes:[],links:[],linkName:[]},a={nodes:[],links:[]},r=e.header.length,i=0;r-1>i;i++)i==r-2&&(t.linkName=t.nodes),t.nodes=t.nodes.concat(d(e.data,i));t.linkName.map(function(e){t.links[e]={}}),e.data.map(function(e){for(var a=0;r-2>a;a++)isNaN(t.links[e[a]][e[a+1]])?t.links[e[a]][e[a+1]]=Number.parseFloat(e[r-1]):t.links[e[a]][e[a+1]]+=Number.parseFloat(e[r-1])}),t.nodes.map(function(e){a.nodes.push({name:e})});for(var o in t.links)for(var s in t.links[o])a.links.push({source:o,target:s,value:t.links[o][s]});return a}function O(e){var t=a(e.url);if(0===t.rows||t.cols<=2)return!1;var r={title:t.title,subTitle:t.source,rows:t.rows,series:M(t)};return r}function I(e,t){for(var a=JSON.stringify(e),r=!1,i=t.length,o=0;i>o&&!r;o++)a==JSON.stringify(t[o])&&(r=!0);return r||t.push(e),t}function B(e){for(var t={nodes:[],nodesName:[],links:[]},a={categories:[],nodes:[],links:[],legend:[]},r=[],i=e.header.length,o=0,s=90/i,l=[],n=0;i-1>n;n++){var x=s*(i-n);l[n]=x.toFixed(0)}return a.legend=d(e.data,0),a.legend.map(function(s,n){a.categories.push({name:s}),r[s]=n,t.nodesName[n]=[],t.nodes[n]=[];for(var x=0;i-1>x;x++){var m=d(e.data,x,s,0);m.map(function(e,a){t.nodes[n][e]={name:e,value:0,category:n,id:o,symbolSize:l[x]},o++})}}),e.data.map(function(e){for(var a=0;i-2>a;a++){var o=r[e[0]],s=e[a],l=e[a+1];t.links.push({source:t.nodes[o][s].id,target:t.nodes[o][l].id}),t.nodes[o][s].value+=Number.parseFloat(e[i-1])}t.nodes[r[e[0]]][e[a]].value+=Number.parseFloat(e[i-1])}),t.nodes.map(function(e){for(var t in e)a.nodes.push(e[t])}),a.links[0]=t.links[0],t.links.map(function(e){a.links=I(e,a.links)}),a}function G(e){var t=a(e.url);if(0===t.rows||t.cols<=2)return!1;var r={title:t.title,subTitle:t.source,rows:t.rows,series:B(t)};return r}function P(e){var t=a(e.url);if(0===t.rows||3!=t.cols)return!1;var r={title:t.title,subTitle:t.source,rows:t.rows,series:[{type:"themeRiver",itemStyle:{emphasis:{shadowBlur:20,shadowColor:"rgba(0, 0, 0, 0.8)"}},data:t.data}],legend:{data:d(t.data,2),x:"center",y:70,itemGap:20,textStyle:{fontSize:16}}};return r}function R(e){var r,i,o,s,l=[];if(r=a(e.url),l.title=r.title,l.subTitle=r.source,l.rows=r.rows,0===r.rows)return l;if(3==r.cols){for(l.xAxisTitle=r.header[1].title,l.yAxisTitle=r.header[2].title,l.legend=d(r.data,0),l.xAxis=d(r.data,1),l.yAxis=[],o=0;o<l.legend.length;o++)for(l.yAxis[l.legend[o]]=[],s=0;s<l.xAxis.length;s++)l.yAxis[l.legend[o]][s]="-";for(o=0;o<r.rows;o++)for(i=r.data[o][0],s=0;s<l.xAxis.length;s++)if(r.data[o][1]==l.xAxis[s]){l.yAxis[i][s]=Number.parseFloat(r.data[o][2]);break}for(l.series=[],o=0;o<l.legend.length;o++)l.series[o]={name:l.legend[o],type:"line",smooth:e.smooth,data:l.yAxis[l.legend[o]],label:{normal:{show:!1}}}}else if(2==r.cols)l.xAxisTitle=r.header[0].title,l.yAxisTitle=r.header[1].title,l.legend=[],l.legend[0]=l.yAxisTitle,l.xAxis=x(r.data,0),l.yAxis=x(r.data,1),l.series=[],l.series[0]={name:l.yAxisTitle,type:"line",smooth:e.smooth,data:l.yAxis,label:{normal:{show:!1}}};else if(1==r.cols){for(l.xAxisTitle="数据编号",l.yAxisTitle=r.header[0].title,l.legend=[],l.legend[0]=l.yAxisTitle,arrTemp=[],o=0;o<r.rows;o++)arrTemp[o]=o+1;for(l.xAxis=arrTemp,l.yAxis=[],o=0;o<r.rows;o++)l.yAxis[o]=Number.parseFloat(r.data[o][0]);l.series=[],l.series[0]={name:l.yAxisTitle,type:"line",smooth:e.smooth,data:l.yAxis,label:{normal:{show:!1}}}}if(r.cols<=3)for(o=0;o<l.legend.length;o++){var n=t.pChart(l.series[o].data);l.series[o].markLine={lineStyle:{normal:{type:"dashed"}},symbolSize:0,label:{normal:{position:"end",formatter:"{b}:\n{c}"}},data:[{name:"UCL",yAxis:n.UCL},{name:"CL",yAxis:n.CL},{name:"LCL",yAxis:n.LCL,lineStyle:{normal:{color:"#ea2333"}}}]}}return l}var D;switch(r.type){case"bar":case"line":D=p(r);break;case"spc":D=R(r);break;case"boxplot":D=y(r);break;case"pie":case"funnel":D=w(r);break;case"sunrise":D=b(r);break;case"parallel":D=W(r);break;case"treemap":D=C(r);break;case"radar":D=N(r);break;case"scatter":D=F(r);break;case"sankey":D=O(r);break;case"graph":D=G(r);break;case"themeriver":D=P(r)}return D},d=function(e){var t={title:[{text:o.title,x:"center"},{text:o.subTitle,borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:3},{text:s.trim(),borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:18},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:"right",y2:3}],grid:{left:"5%",right:"5%",top:"8%",bottom:"10%",containLabel:!0},connectNulls:!0,toolbox:{left:"left",show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},dataZoom:{show:!0},magicType:{show:!0,type:["line","bar","stack","tiled"]},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,tooltip:{backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"},trigger:"boxplot"==e.type?"item":"axis",axisPointer:{type:"line"==e.type?"line":"shadow",lineStyle:{color:"#aaa"},crossStyle:{color:"#aaa"},shadowStyle:{color:"rgba(128,200,128,0.1)"}}},dataZoom:[{type:"inside",realtime:!0,start:0,end:100},{show:"h"==e.dataZoom||"vh"==e.dataZoom?!0:!1,realtime:!0,start:0,end:100,height:20,y2:25},{show:"v"==e.dataZoom||"vh"==e.dataZoom?!0:!1,yAxisIndex:0,filterMode:"empty",width:12,height:"70%",handleSize:8,showDataShadow:!1,right:5}],legend:{data:o.legend,x2:"5%",y:40,itemGap:20,textStyle:{fontSize:16},show:o.legend.length<=1?!1:!0},xAxis:[{name:o.xAxisTitle,nameTextStyle:{fontSize:16},axisTick:{show:!0,length:8,lineStyle:{color:"#aaa",width:2}},axisLabel:{textStyle:{fontSize:16}},type:"category",boundaryGap:"line"==e.type?!1:!0,data:o.xAxis}],yAxis:[{name:o.yAxisTitle,nameLocation:"middle",nameGap:35,nameTextStyle:{fontSize:16},type:"value",position:"left",scale:!0,axisLabel:{show:!0,interval:"auto",margin:10,textStyle:{fontSize:16}},axisTick:{show:!1}}],series:o.series};if("0"!=e.max&&(t.yAxis[0].max=Number.parseFloat(e.max)),"0"!=e.min&&(t.yAxis[0].min=Number.parseFloat(e.min)),"boxplot"==e.type&&(t.title[2]={text:"上须: Q3 + 1.5 * IRQ \n下须: Q1 - 1.5 * IRQ\nIRQ: Q3-Q1",borderColor:"#999",borderWidth:1,textStyle:{fontSize:14},x2:"5%"},o.legend.length<5?t.title[2].y=70:t.title[2].y2=110,e.minMax&&(t.title[2].text="上须: 最大值 \n下须: 最小值")),e.reverse){var a;a=t.xAxis,t.xAxis=t.yAxis,t.yAxis=a}return t},x=function(e){var t={title:[{text:o.title,x:"center"},{text:o.subTitle,borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:3},{text:s.trim(),borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:18},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x:10,y2:3}],grid:{left:"5%",right:"5%",top:"8%",bottom:"10%",containLabel:!0},connectNulls:!0,toolbox:{left:"left",show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},dataZoom:{show:!0},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,tooltip:{backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"},trigger:"axis",axisPointer:{type:"line"==e.type?"line":"shadow",lineStyle:{color:"#aaa"},crossStyle:{color:"#aaa"},shadowStyle:{color:"rgba(128,200,128,0.1)"}}},dataZoom:[{type:"inside",realtime:!0,start:0,end:100},{show:"h"==e.dataZoom||"vh"==e.dataZoom?!0:!1,realtime:!0,start:0,end:100,height:20,y2:25},{show:"v"==e.dataZoom||"vh"==e.dataZoom?!0:!1,yAxisIndex:0,filterMode:"empty",width:12,height:"70%",handleSize:8,showDataShadow:!1,right:5}],legend:{data:o.legend,x2:"5%",y:40,itemGap:20,textStyle:{fontSize:16},selectedMode:"single",show:o.legend.length<=1?!1:!0},xAxis:[{name:o.xAxisTitle,nameTextStyle:{fontSize:16},axisTick:{show:!1},type:"category",boundaryGap:"line"==e.type?!1:!0,data:o.xAxis}],yAxis:[{name:o.yAxisTitle,nameLocation:"middle",nameGap:35,nameTextStyle:{fontSize:16},type:"value",position:"left",scale:!0,axisLabel:{show:!0,interval:"auto",margin:8},axisTick:{show:!1}}],series:o.series};return t},m=function(e){var t={title:[{text:o.title,x:"center"},{text:o.subTitle,borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:3},{text:s.trim(),borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:18},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:10,y2:3}],tooltip:{backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"},trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},grid:{left:"5%",right:"5%",top:"8%",bottom:"10%",containLabel:!0},toolbox:{left:"left",show:e.toolbox,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},calculable:!0,legend:o.legend,series:o.series};return"funnel"==e.type&&(t.series.length>1?(t.series[0].width="60%",t.series[0].height="40%",t.series[0].left="20%",t.series[0].top="10%",t.series[0].label={normal:{position:"inner"}},t.series[0].labelLine={normal:{show:!1}},t.series[1].width="60%",t.series[1].height="40%",t.series[1].left="20%",t.series[1].top="50%",t.series[1].sort="ascending",t.series[1].label={normal:{position:"inner"}},t.series[1].labelLine={normal:{show:!1}}):(t.series[0].width="60%",t.series[0].height="60%",t.series[0].left="20%",t.series[0].top="20%",t.series[0].sort="ascending",t.series[0].label={normal:{position:"inner"}},t.series[0].labelLine={normal:{show:!1}})),t},h=function(e){var t={backgroundColor:"#445",title:[{text:o.title,subtext:o.subTitle+s,x:"center",textStyle:{color:"#bbb"}},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal",color:"#aaa"},x2:10,y2:3}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},parallel:{left:"50",right:"50",top:120,parallelAxisDefault:{type:"value",nameLocation:"start",nameGap:20,nameTextStyle:{color:"#aaa",fontSize:12},axisLine:{lineStyle:{color:"#aaa"}},axisTick:{lineStyle:{color:"#aaa"}},splitLine:{show:!1},axisLabel:{textStyle:{color:"#aaa"}}}},parallelAxis:o.parallelAxis,visualMap:o.visualMap,legend:o.legend,series:o.series};return t},p=function(e){var t=function(){this.encodeHTML=function(e){return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},this.addCommas=function(e){return isNaN(e)?"-":(e=(e+"").split("."),e[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(e.length>1?"."+e[1]:""))}},a=(new t,{title:[{text:o.title,subtext:o.subTitle+s,x:"center"},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:14,fontWeight:"normal"},x2:10,y2:2}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},tooltip:{backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"},formatter:function(e){for(var t=e.value,a=e.treePathInfo,r=[],i=1;i<a.length;i++)r.push(a[i].name);return r.join("/")+"<br>"+a[0].name+": "+t}},series:o.series});return a},u=function(e){var t={title:[{text:o.title,x:"center"},{text:o.subTitle,borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:3},{text:s.trim(),borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:18},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:"right",y2:3}],toolbox:{show:!0,feature:{dataView:{readOnly:!1},restore:{},saveAsImage:{}}},tooltip:{backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"}},legend:o.legend,radar:{indicator:o.radarIndicator,shape:e.shape,name:{textStyle:{color:"#555"}},splitLine:{lineStyle:{color:"#bbb"}},center:["50%","58%"],radius:"75%",splitArea:{show:!1}},series:o.series};return t},y=function(e){var t={title:[{text:o.title,x:"center"},{text:o.subTitle,borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:3},{text:s.trim(),borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:18},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:"right",y2:3}],grid:{left:"5%",right:"5%",top:"8%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{mark:{show:!0},dataView:{show:!0,readOnly:!1},dataZoom:{show:!0},restore:{show:!0},saveAsImage:{show:!0}}},tooltip:{trigger:"axis",showDelay:0,backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"},formatter:function(e){return e.value.length>1?e.seriesName+" :<br/>"+e.value[0]+" , "+e.value[1]+" ":e.seriesName+" :<br/>"+e.name+" : "+e.value},axisPointer:{show:!0,type:"cross",lineStyle:{type:"dashed",width:1}}},dataZoom:[{type:"inside",realtime:!0,start:0,end:100},{show:!1,realtime:!0,start:0,end:100,height:20,y2:25},{type:"inside",yAxisIndex:0,realtime:!0,start:0,end:100},{show:!1,yAxisIndex:0,filterMode:"empty",width:12,height:"70%",handleSize:8,showDataShadow:!1,right:5}],xAxis:[{name:o.xAxisName,type:"value",axisTick:{show:!1},boundaryGap:!1,scale:!0,axisLabel:{show:!0},axisLine:{show:!0}}],yAxis:[{name:o.yAxisName,type:"value",scale:!0,position:"left",axisLabel:{show:!0,interval:"auto",margin:8},axisTick:{show:!1},axisLine:{show:!0}}],legend:o.legend,series:o.series};return t},c=function(e){var t={title:[{text:o.title,x:"center"},{text:o.subTitle,borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:3},{text:s.trim(),borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:18},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",
borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:"right",y2:3}],grid:{left:"5%",right:"5%",top:"8%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},tooltip:{trigger:"item",triggerOn:"mousemove",backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"}},series:{type:e.type,data:o.series.nodes,links:o.series.links,layout:"none",itemStyle:{normal:{borderWidth:1,borderColor:"#aaa"}},lineStyle:{normal:{colorMode:"source",curveness:.5,opacity:.5}}}};return t},f=function(e){var t={title:[{text:o.title,x:"center"},{text:o.subTitle,borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:3},{text:s.trim(),borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:18},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:"right",y2:3}],grid:{left:"5%",right:"5%",top:"8%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},legend:{data:o.series.legend,x:"center",y:70,itemGap:20,textStyle:{fontSize:16}},tooltip:{backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"}},series:{name:"关系图",type:e.type,layout:"1"==e.force?"force":"circular",label:{normal:{position:"right",formatter:"{b}"}},draggable:!0,nodes:o.series.nodes,categories:o.series.categories,force:{gravity:.07,edgeLength:100,repulsion:150},links:o.series.links}};return t},g=function(e){var t={title:[{text:o.title,x:"center"},{text:o.subTitle,borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:3},{text:s.trim(),borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:5,y2:18},{text:"©成都印钞有限公司 技术质量部",borderColor:"#999",borderWidth:0,textStyle:{fontSize:10,fontWeight:"normal"},x:"right",y2:3}],grid:{left:"5%",right:"5%",top:"8%",bottom:"10%",containLabel:!0},toolbox:{show:!0,feature:{dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},tooltip:{trigger:"axis",axisPointer:{type:"line",lineStyle:{color:"rgba(0,0,0,0.2)",width:1,type:"solid"}},backgroundColor:"#fff",extraCssText:"box-shadow: 0 0 3px #e6e6e6;border-radius:4px;border:1px solid #d4d4d4;padding:10px;",textStyle:{color:"#333"}},singleAxis:{axisTick:{},axisLabel:{},bottom:"10%",type:"time",splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}},legend:o.legend,series:o.series};return t},b=function(e){o=n(e);var t=e.url.split("tstart=")[1],a=jsLeft(t,8),i=jsLeft(t.split("tend=")[1],8);if(s="     统计时间："+a+" - "+i,0==o.rows)return!1;var l;switch(e.type){case"bar":case"line":case"boxplot":l=d(e);break;case"spc":l=x(e);break;case"pie":case"funnel":case"sunrise":l=m(e);break;case"parallel":l=h(e);break;case"treemap":l=p(e);break;case"radar":l=u(e);break;case"scatter":l=y(e);break;case"sankey":l=c(e);break;case"graph":l=f(e);break;case"themeriver":l=g(e)}return 1==e.banknoteColor&&"undefined"!=typeof l.legend&&(l.color=r(l.legend.data,e.color)),"undefined"!=typeof l.legend&&l.legend.data.length>4&&(l.grid.right="15%",l.legend.orient="vertical",l.legend.x="right"),l};return{getOption:b}});
//# sourceMappingURL=chartDataTool.min.js.map